print("Testing step4: build_dataframe")
def build_dataframe(n):
    import numpy as np
    import pandas as pd
    idx = [i for i in range(n)]
    squares = [i * i for i in idx]
    cubes = [i * i * i for i in idx]

    # 使用 numpy 对列表进行转换
    arr_idx = np.array(idx)
    arr_sq = np.array(squares)
    arr_cb = np.array(cubes)

    # 用 dict 合并数据并实例化 pandas.DataFrame
    data = {"x": arr_idx, "x2": arr_sq}
    df = pd.DataFrame(data)
    df2 = df  # alias

    # 给 df2 增加一列 x3
    df2["x3"] = arr_cb

    # 创建一个分组列（偶数/奇数）
    df2["cat"] = ["even" if i % 2 == 0 else "odd" for i in arr_idx]

    return df2

try:
    df = build_dataframe(5)
    print("DataFrame created successfully")
    print("DataFrame shape:", df.shape)
    print("DataFrame columns:", list(df.columns))
    print("First few rows:")
    print(df.head())
except Exception as e:
    print("ERROR in build_dataframe:", e)
